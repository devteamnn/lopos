Универсальные модули (загрузка и отрисовка)
===========================================

------------------------------------------------------------------------

universal-keywords.js
---------------------

**downloadAndDraw** - загружает и отрисовывает ключевые слова в
указанном контейнере

-   контейнер для отрисовки
-   обработчик, который будет назначен каждому элементу. Обработчик
    может использовать ноду ключевого слова как `evt.target`, внутри
    которых получить `data-keyword-id` и `data-keyword-rgb`

        const onKeywordClick = (evt) => evt.target.classList.toggle('keyword__mute');

-   модификатор, необязательный параметр, принимает на вход keywordId и
    keywordNode, на основании которых выполняет операции, например,
    назначает класс

        // функция keywordModificator, как и массив goodTags, определены в стороннем модуле 
        const keywordModificator = (keywordId, keywordNode) => {
          if (goodTags.every((tagItem) => (tagItem.id !== keywordId))) {
        keywordNode.classList.add('keyword__mute');
          }
        };

**getDataAndDraw** - отрисовывает ключевые слова по переданному массиву
данных

-   контейнер для отрисовки
-   обработчик (аналогично downloadAndDraw)
-   объект с данными ключевого слова


universal-groups-list.js
-----------------------

*Универсальный модуль отрисовки списка групп в контейнере:*

**Принимает на вход:**

- данные,
- контейнер,
- обработчик

**Замечания про обработчик:**

1. так как ноды в контейнер добавляются по массиву данных, то обработчик может принимать на вход объект-параметр group, в котором использовать свойства id, name, level, count (и прочее из возвращаемых сервером)
2. Обработчик автоматически помещает в sessionStorage свойства currentGroupId, currentGroupName и currentGroupLevel

universal-goods-list.js
-----------------------

*Универсальный модуль отрисовки списка товаров в контейнере:*

**Принимает на вход:**

- данные,
- контейнер,
- обработчик
- необязательный флаг-строку, который принудительно выводит список в виде плитки ('tile') или строк('string'). Если параметр не указан, то вывод зависит от настроек

**Замечания про обработчик:**

1. так как ноды в контейнер добавляются по массиву данных, то обработчик может принимать на вход параметр good, в котором использовать свойства id и name (и прочее из возвращаемых сервером)
2. Обработчик автоматически помещает в sessionStorage свойство currentGoodId


universal-search.js
---------------------
*Модуль универсального мини-поиска*

**Принимает на вход:**

- массив объектов данных
- ключевое слово

**Замечания:** модуль рассчитывает на то, что в каждом объекте массива есть поле name, которое с будет сравниваться с ключевым словом 

Универсальные модули (экраны приложения)
----------------------------------------

Инструменты
===========================================

xhr.js
---------------------
*Модуль работы с сетью*

**Принимает на вход:**
  set request(parameters)

  parameters = {
    let urlApi  - ссылка на API (все что после https://lopos.bidone.ru/api/v1/)
    let metod - метод HTTP
    let data - данные POST запроса (работает через FormData)

    function callbackSuccess(responce) - коллбэк при успешном вызове - принимает на вход объект, возвразаемый сервером

    function callbackError() - НЕОБЯЗАТЕЛЬНЫЙ параметр. Если есть, то вызывается при любой ошибке.
  }

**Замечания:** 
- все ошибки и сообщения отрисовываются в модуле
- https://lopos.bidone.ru/api/v1/ подставляется в сылку в модуле

form-tools.js
---------------------
*Модуль работы с сетью*

**Замечания:** 
- Модуль работает только с одной формой. Для переключения формы - нужно вызвать ***reset*** и ***work*** с параметрами новой формы.
- Модуль разрабатывался для работы в обертке.

**Методы:**
- ***work(remoteModal, remoteSubmitCallback, remoteValidCallback)***
Автоматизированная валидация и отправка модальных окон. Метод сам ищет помеченные тегами data-* поля для валидации, места вывода ошибок, блокирует и разблокирует кнопку отправки, устанавливает и снимает ошибки валидации. Добавляет и снимает обработчики на закрытие модального окна.

Параметры:
- remoteModal - нода модального окна

- remoteSubmitCallback - вызывается для при отправке формы. В этой функции настраивается xhr и вызывается метод form-tools submit

- remoteValidCallback - Возвращает true/false. НЕОБЯЗАТЕЛЬНЫЙ ПАРАМЕТР. Вызывается при вадидации. Используется когда нужно валидировать поля, которы нельзя валидировать автоматически. Возвращаемое значение складывается по И с результатом основной валидации.

теги в разметке:
<form>
  data-formName = appSettings.{formName}

<input>
  data-valid = appSettings.formName.validPatterns.{valid} = appSettings.formName.validMessage.{data-validLabel}
      примечание: имя этого поля должно быть равно параметру с паттерном и сообщением об ошибке валидации

  data-validLabelName = data-validLabel на <span> сообщении о валидации

<span> (Сяда выводится сообщение)
  data-validLabel = 'имя поля'

<спиннер>
  data-spinner

<кнопка отмены>
  data-butCancel

Тег для всех элементов отмены (по клику на них сбрасывается форма - крестик, кнопка отмены, фон модального окна)
  data-cancel

- ***reset()***
Сбрасывает текущую форму, снимает все обработчики, скрывает сообщения

- ***removeHandlers()***
Удаляет все обработчики с текущей формы

- ***validElement(el)***
Валидирует переданный элемент. Сообщение показывает сам.

el - нода, которую нужно валидировать. data- атрибуты расставляются так же как и при методе ***work***

- ***submit(data)***
Отправляет xhr запрос

data - объект с параметрами для xhr запроса.

Обертка для form-tools.js
---------------------
Организует логику валидации и отправки формы.

Самая распространенная реализация для отправки на 1 ссылку без дополнительной логики:

глобальные переменные модуля (modal, form и т.д.)
function callbackXhrSuccess(responce) - скрываем окно, сбрасываем форму (***form-tools.reset()***), что-то перерисовываеv или отображаем
function callbackXhrError() - скрываем окно, сбрасываем форму (***form-tools.reset()***)
function submitForm() - формируем данные для xhr, вызываем (***form-tools.submit(data)***)

export:
  function start(modal) - принимает ноду окна, инициализирует глобальные переменные, вызывает 
      (***form-tools.work(modal, submitForm)***)
  function stop() - сбрасывает форму (***form-tools.reset()***)

single-validation.js
---------------------
Простая валидация одного поля. Проверяет на соответствие с паттерном и выводит или скрывает ошибку. Навешивает и снимает обработчик на снятие ошибки сам.

- ***data-атрибуты такие же как и form-tools***
(data-valid, data-validLabelName, data-validLabel. data-valisettings)

***data-valisettings = data-formName***  - используется вместо data-formName в form-tools. Равен названию формы в appSettings.

Используется в формах, интегрированных в экран приложения (не в модальных окнах)

function valid(el) - Возвращает true/false.
- el - нода, которую нужно валидировать.



